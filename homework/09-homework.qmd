---
title: "Homework 09"
author: "Alec L. Robitaille"
date: "2023-05-04"
---

```{r, include = FALSE}
source('R/packages.R')
```

```{r, eval = FALSE}
source('R/packages.R')
```


## Data 

The data in data(Achehunting) are 14,364 individual hunting trips by 147 men
among the indigenous Aché of Paraguay. Each trip has recorded the hunter’s identity
(anonymized id), hunter’s age at the time of the trip, the duration in hours of the
trip, and the kilograms of meat returned. Many of the trips have missing values for
duration.

```{r}
# Data
source('R/data_achehunting.R')

# month : Month of record
# day : Day of record
# year : Year of record
# id : Identifier of individual man
# age : Man's age at time of record
# kg.meat : Kilograms of meat returned from hunt
# hours : Duration in hours of hunting trip
# datatype : 1 if duration of trip known, 3 otherwise

DT_hunting <- data_achehunting()
```



## Question 1

> 1. In this first problem, estimate the influence of age on the probability of trip success. Define “success” as a trip that returns any non-zero amount of meat. Ignore
individual hunter identities for now. You can use any functional relationship for age
and success that you think is sensible, but be sure to justify it and check it against
posterior predictions.


```{r}
get_prior(success ~ age, family = 'binomial', data = DT_hunting)
```

### Priors

```{r}
tar_load(m_h09_q01_prior)
m_h09_q01_prior$prior
conditional_effects(m_h09_q01_prior)
mcmc_areas(m_h09_q01_prior, regex_pars = 'b')
```

### Posterior


```{r}
tar_load(m_h09_q01)
m_h09_q01$prior
conditional_effects(m_h09_q01)
mcmc_areas(m_h09_q01, regex_pars = 'b')
```



## Question 2

> 2. Now incorporate individual hunter varying effects into your analysis from the
previous problem. Allow the influence of age on success to vary by each individual.
How much variation in success is explained by individuals and how much by age?

### Priors

```{r}
get_prior(success ~ age + (1 | id), family = 'binomial', data = DT_hunting)
```

### Posterior

```{r}
tar_load(m_h09_q02)
m_h09_q02

mcmc_areas(m_h09_q02, regex_pars = 'b|sd')
```

